{{
# ------ INSTRUCTION --------------------------------------
# invoke this template by using render command line utility
# like this:
#
# render -i iptables_template.conf.tmpl -j iptables_template.conf.ctx
#
# See also:
#    iptables_template_render.py
#    iptables_template_decorator.py
# ---------------------------------------------------------
}}
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
{{for dport in dports:}}
-A INPUT -i {{=interface}} -p {{=protocol}} --dport {{=dport}} -m state --state NEW,ESTABLISHED -j ACCEPT
{{pass}}
-A INPUT -i lo -j ACCEPT
-A INPUT -j DROP
-A FORWARD -j DROP
-A OUTPUT -j ACCEPT
